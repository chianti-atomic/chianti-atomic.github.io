
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ChiantiPy.tools package &#8212; ChiantiPy 0.15.1 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Notes" href="../notes.html" />
    <link rel="prev" title="ChiantiPy.tests package" href="ChiantiPy.tests.html" /> 
  </head><body>
<div style="padding: 20px 10px 10px 40px; background-color: #fff8d3; text-align: left;">
<a href="">
<img border="0" alt="chiantipy" src="_static/chiantipy_logo.png"/>
</a>
</div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../notes.html" title="Notes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ChiantiPy.tests.html" title="ChiantiPy.tests package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ChiantiPy 0.15.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >ChiantiPy’s API documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ChiantiPy.html" accesskey="U">ChiantiPy package</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="ChiantiPy.tests.html"
                        title="previous chapter">ChiantiPy.tests package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../notes.html"
                        title="next chapter">Notes</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chiantipy-tools-package">
<h1>ChiantiPy.tools package<a class="headerlink" href="#chiantipy-tools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ChiantiPy.tools.archival">
<span id="chiantipy-tools-archival-module"></span><h2>ChiantiPy.tools.archival module<a class="headerlink" href="#module-ChiantiPy.tools.archival" title="Permalink to this headline">¶</a></h2>
<p>Functions for reading pre-v8 CHIANTI files</p>
<dl class="function">
<dt id="ChiantiPy.tools.archival.elvlcRead">
<code class="sig-prename descclassname">ChiantiPy.tools.archival.</code><code class="sig-name descname">elvlcRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=0</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">useTh=0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.archival.elvlcRead" title="Permalink to this definition">¶</a></dt>
<dd><p>read a chianti energy level file and returns
{“lvl”:lvl,”conf”:conf,”term”:term,”spin”:spin,”l”:l,”spd”:spd,”j”:j
,”mult”:mult,”ecm”:ecm,”eryd”:eryd,”ecmth”:ecmth,”erydth”:erydth,”ref”:ref,”pretty”:pretty, ‘ionS’:ions}
if a energy value for ecm or eryd is zero(=unknown), the theoretical values
(ecmth and erydth) are inserted</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.archival.elvlcWrite">
<code class="sig-prename descclassname">ChiantiPy.tools.archival.</code><code class="sig-name descname">elvlcWrite</code><span class="sig-paren">(</span><em class="sig-param">info</em>, <em class="sig-param">outfile=None</em>, <em class="sig-param">addLvl=0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.archival.elvlcWrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Chianti data to .elvlc file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>info</strong> (<cite>dict</cite>) – Information about the Chianti data to write. Should contain
the following keys: ionS, the Chianti style name of the ion such as c_4
conf, an integer denoting the configuration - not too essential
term, a string showing the configuration
spin, an integer of the spin of the state in LS coupling
l, an integer of the angular momentum quantum number
spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc
j, a floating point number, the total angular momentum
ecm, the observed energy in inverse cm, if unknown, the value is 0.
eryd, the observed energy in Rydbergs, if unknown, the value is 0.
ecmth, the calculated energy from the scattering calculation, in inverse cm
erydth, the calculated energy from the scattering calculation in Rydbergs
ref, the references in the literature to the data in the input info</p></li>
<li><p><strong>outfile</strong> (<cite>str</cite>) – Output filename. ionS+’.elvlc’ (in current directory) if None</p></li>
<li><p><strong>addLvl</strong> (<cite>int</cite>) – Add a constant value to the index of all levels</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For use with files created before elvlc format change in November 2012</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.io.elvlcWrite" title="ChiantiPy.tools.io.elvlcWrite"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChiantiPy.tools.io.elvlcWrite()</span></code></a></dt><dd><p>Write .elvlc file using the new format.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.archival.wgfaRead">
<code class="sig-prename descclassname">ChiantiPy.tools.archival.</code><code class="sig-name descname">wgfaRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">elvlcname=-1</em>, <em class="sig-param">total=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.archival.wgfaRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI data from a .wgfa file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>elvlcname</strong> (<cite>str</cite>) – If specified, the lsj term labels are returned in the <cite>pretty1</cite> and <cite>pretty2</cite> keys of <cite>Wgfa</cite></p></li>
<li><p><strong>total</strong> (<cite>bool</cite>) – Return the level 2 avalue data in <cite>Wgfa</cite></p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Wgfa</strong> – Information read from the .wgfa file. The dictionary structure is {“lvl1”,”lvl2”,”wvl”,”gf”,”avalue”,”ref”,”ionS”,”filename”}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is text-wise not different than the v8 version except that it uses the
archival elvlcRead in <cite>~ChiantiPy.tools.archival</cite> though this has now been commented out. Can this routine be removed? Should the elvlcRead routine be uncommented?</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.io.wgfaRead" title="ChiantiPy.tools.io.wgfaRead"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChiantiPy.tools.io.wgfaRead()</span></code></a></dt><dd><p>Read .wgfa file with the new format.</p>
</dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools.constants">
<span id="chiantipy-tools-constants-module"></span><h2>ChiantiPy.tools.constants module<a class="headerlink" href="#module-ChiantiPy.tools.constants" title="Permalink to this headline">¶</a></h2>
<p>A set of physical constants, in (mostly) cgs unit system. Most are from <a class="footnote-reference brackets" href="#id2" id="id1">11</a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">11</a></span></dt>
<dd><p>NIST Reference on Constants, Units and Uncertainty (<a class="reference external" href="http://physics.nist.gov/cuu">link</a>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Many of these can be replaced by the <cite>~astropy.constants</cite> module. Elemental symbols can be removed
in favor of the periodictable module. Spectroscopic roman numerals can be removed in favor of roman
module. The Gauss-Laguerre weights can be calculated by <cite>~numpy.polynomial.laguerre.laggauss</cite>.</p>
</div>
<div class="section" id="module-ChiantiPy.tools.data">
<span id="chiantipy-tools-data-module"></span><h2>ChiantiPy.tools.data module<a class="headerlink" href="#module-ChiantiPy.tools.data" title="Permalink to this headline">¶</a></h2>
<p>Module for collecting various top-level Chianti data</p>
<p>Descriptions for <cite>keywordArgs</cite>:</p>
<ul class="simple">
<li><p><cite>temperature</cite> : temperature (in K)</p></li>
<li><p><cite>eDensity</cite> : electron density (in <span class="math notranslate nohighlight">\(\mathrm{cm}^{-3}\)</span>)</p></li>
<li><p><cite>hDensity</cite> : hydrogen density (in <span class="math notranslate nohighlight">\(\mathrm{cm}^{-3}\)</span>)</p></li>
<li><p><cite>pDensity</cite> : proton density (in <span class="math notranslate nohighlight">\(\mathrm{cm}^{-3}\)</span>)</p></li>
<li><p><cite>radTemperature</cite> : radiation temperature of central source (in K)</p></li>
<li><p><cite>rStar</cite> : distance of the plasma from the source (in units of the source’s radius)</p></li>
<li><p><cite>distance</cite> : distance from the central source</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>XUVTOP</strong> (<em>str</em>) – the root of the CHIANTI database</p></li>
<li><p><strong>Defaults</strong> (<em>dict</em>) – default values used by ChiantiPy, can also be set by an optional HOME/.chianti/chiantirc file</p></li>
<li><p><strong>Ip</strong> (<em>np.ndarray</em>) – the ionization potentials for all ionization stages up to Zn, in eV</p></li>
<li><p><strong>MasterList</strong> (<em>list</em>) – the CHIANTI style names of all ions in the CHIANTI database</p></li>
<li><p><strong>IoneqAll</strong> (<em>dict</em>) – a dict containing the ionization equilibrium values for the default ionization file</p></li>
<li><p><strong>ChiantiVersion</strong> (<em>str</em>) – the version of the CHIANTI database</p></li>
<li><p><strong>AbundanceDefault</strong> (<em>dict</em>) – the elemental abundances in the default abundance file</p></li>
<li><p><strong>AbundanceList</strong> (<em>list</em>) – the names of all abundance files included in the CHIANTI database</p></li>
<li><p><strong>GrndLevels</strong> (<em>list</em>) – the number of levels that should be considered in an ionization calculation</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="module-ChiantiPy.tools.filters">
<span id="chiantipy-tools-filters-module"></span><h2>ChiantiPy.tools.filters module<a class="headerlink" href="#module-ChiantiPy.tools.filters" title="Permalink to this headline">¶</a></h2>
<p>Line profile filters for creating synthetic spectra.</p>
<dl class="function">
<dt id="ChiantiPy.tools.filters.boxcar">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">boxcar</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.boxcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Box-car filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength filter should be centered on.</p></li>
<li><p><strong>factor</strong> (<cite>~numpy.float64</cite>) – Full width of the box-car filter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.filters.gaussian">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">gaussian</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>A gaussian filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength filter should be centered on.</p></li>
<li><p><strong>factor</strong> (<cite>~numpy.float64</cite>) – Gaussian width</p></li>
<li><p><strong>integrated value is unity</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.filters.gaussianR">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">gaussianR</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=1000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.gaussianR" title="Permalink to this definition">¶</a></dt>
<dd><p>A gaussian filter where the gaussian width is given by <cite>wvl0</cite>/<cite>factor</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength filter should be centered on.</p></li>
<li><p><strong>factor</strong> (<cite>~numpy.float64</cite>) – Resolving power</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.filters.lorentz">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">lorentz</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.lorentz" title="Permalink to this definition">¶</a></dt>
<dd><p>Lorentz profile filter with the exception that all factors are in wavelength units
rather than frequency as the lorentz profile is usually defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength filter should be centered on.</p></li>
<li><p><strong>factor</strong> (<cite>~numpy.float64</cite>) – Value of the so-called constant gamma</p></li>
<li><p><strong>integrated value is unity</strong></p></li>
<li><p><strong>the FWHM is 2*gamma</strong></p></li>
<li><p><strong>.. math::</strong> – L = frac{1}{pi gamma} frac{ gamma^2}{(lambda - lambda_0)^2 + gamma^2}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.filters.moffat">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">moffat</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=2.5</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.moffat" title="Permalink to this definition">¶</a></dt>
<dd><p>Moffat profile with parameters suited to Chandra Letg spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength the filter is centered on.</p></li>
<li><p><strong>factor</strong> (<cite>~numpy.float64</cite>) – Resolving power (TODO: correct description)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.filters.voigt">
<code class="sig-prename descclassname">ChiantiPy.tools.filters.</code><code class="sig-name descname">voigt</code><span class="sig-paren">(</span><em class="sig-param">wvl</em>, <em class="sig-param">wvl0</em>, <em class="sig-param">factor=(0.5</em>, <em class="sig-param">1.0)</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.filters.voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>pseudo-Voigt filter
the sum of a Gaussian and a Lorentzian</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<cite>~numpy.ndarray</cite>) – Wavelength array</p></li>
<li><p><strong>wvl0</strong> (<cite>~numpy.float64</cite>) – Wavelength the filter is centered on.</p></li>
<li><p><strong>factor</strong> (<em>array-type</em>) – contains the following 2 parameters</p></li>
<li><p><strong>A</strong> (<cite>~numpy.float64</cite>) – relative size of gaussian and lorentz components
must be between 0. and 1. but this is not currently checked</p></li>
<li><p><strong>sigma</strong> (<cite>~numpy.float64</cite>) – the gaussian width of the gaussian profile (the standard deviation)
also creates the lorentz component with the same fwhm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools.io">
<span id="chiantipy-tools-io-module"></span><h2>ChiantiPy.tools.io module<a class="headerlink" href="#module-ChiantiPy.tools.io" title="Permalink to this headline">¶</a></h2>
<p>Reading and writing functions</p>
<p>TODO:  see if klgfbRead is needed or not</p>
<dl class="function">
<dt id="ChiantiPy.tools.io.abundanceRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">abundanceRead</code><span class="sig-paren">(</span><em class="sig-param">abundancename=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.abundanceRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read abundance file <cite>abundancename</cite> and return the abundance values relative to hydrogen</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abundancename</strong> (<cite>str</cite>) – the name of the abundance file in the $XUVTOP/abundance directory to be read
the default is an empty string and then the ‘default’ abundance values are read</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – if true, prints out some info</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.autoRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">autoRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">total=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.autoRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI autoionization rates from a .auto file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>elvlcname</strong> (<cite>str</cite>) – If specified, the lsj term labels are returned in the ‘pretty1’ and ‘pretty2’
keys of ‘Wgfa’ dict</p></li>
<li><p><strong>total</strong> (<cite>bool</cite>) – Return the summed level 2 autoionization rates in ‘Auto’</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Auto</strong> – Information read from the .wgfa file. The dictionary structure is
{“lvl1”, “lvl2”, “avalue”, “pretty1”, “pretty2”, “ref”,”ionS”, “filename”}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.autoWrite">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">autoWrite</code><span class="sig-paren">(</span><em class="sig-param">info</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">minBranch=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.autoWrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a CHIANTI .wgfa style file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>info</strong> (<cite>dict</cite>) – Should contain the following:
ionS, the Chianti style name of the ion such as c_4 for C IV,
lvl1, the lower level, the ground level is 1,
lvl2, the upper level, wvl, the wavelength (in Angstroms),
avalue, the autoionization rate,
pretty1, descriptive text of the lower level (optional),
pretty2, descriptive text of the upper level (optiona),
ref, reference text, a list of strings</p></li>
<li><p><strong>outfile</strong> (<cite>str</cite>)</p></li>
<li><p><strong>minBranch</strong> (<cite>~numpy.float64</cite>) – The transition must have a branching ratio greater than the specified to be written to the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.cireclvlRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">cireclvlRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">filetype='cilvl'</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.cireclvlRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read Chianti cilvl, reclvl, or rrlvl files and return data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>filetype</strong> (<cite>str</cite>) – {‘cilvl’, ‘reclvl’, ‘rrlvl’} Type of the file to read</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.convertName">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">convertName</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.convertName" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert ion name string to Z and Ion and other interesting info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<cite>str</cite>) – a generic name of an ion in the CHIANTI database,
such as fe_14 for Fe XIV</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Put in separate module to avoid multiple copies</p>
</div>
<p class="rubric">Notes</p>
<p>A duplicate of the routine in <cite>ChiantiPy.tools.util</cite> but needed by masterList Info</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.defaultsRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">defaultsRead</code><span class="sig-paren">(</span><em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.defaultsRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in configuration from .chiantirc file or set defaults if one is not found.</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.demRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">demRead</code><span class="sig-paren">(</span><em class="sig-param">demName=''</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.demRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read emission measure file <cite>emName</cite> and return the temperatures, densities and emission measures</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><p><strong>demName</strong> (<cite>str</cite>) – the name of the differential emission measure file to read in the $XUVTOP/dem directory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>DEM</strong> – keywords are <cite>temperature</cite>, <cite>density</cite>, <cite>dem</cite>, <cite>em</cite>, <cite>dt</cite>, <cite>filename</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.diRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">diRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.diRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read chianti direct ionization .params files and return data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.drRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">drRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.drRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI dielectronic recombination .drparams files
if filename is set, then reads that file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.eaRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">eaRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.eaRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a CHIANTI excitation-autoionization file and calculate the EA ionization rate data
derived from splupsRead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.elvlcRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">elvlcRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">getExtended=False</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">useTh=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.elvlcRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the new format elvlc files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>getExtended</strong> (<cite>bool</cite>)</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>)</p></li>
<li><p><strong>useTh</strong> (<cite>bool</cite>) – If True, the theoretical values (ecmth and erydth) are inserted when
an energy value for ecm or eryd is zero(=unknown)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.elvlcWrite">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">elvlcWrite</code><span class="sig-paren">(</span><em class="sig-param">info</em>, <em class="sig-param">outfile=None</em>, <em class="sig-param">round=0</em>, <em class="sig-param">addLvl=0</em>, <em class="sig-param">includeRyd=False</em>, <em class="sig-param">includeEv=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.elvlcWrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Chianti data to .elvlc file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>info</strong> (<cite>dict</cite>) – Information about the Chianti data to write. Should contain
the following keys: ionS, the Chianti style name of the ion such as c_4
term, a string showing the configuration
spin, an integer of the spin of the state in LS coupling
l, an integer of the angular momentum quantum number
spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc
j, a floating point number, the total angular momentum
ecm, the observed energy in inverse cm, if unknown, the value is 0.
eryd, the observed energy in Rydbergs, if unknown, the value is 0.
ecmth, the calculated energy from the scattering calculation, in inverse cm
erydth, the calculated energy from the scattering calculation in Rydbergs
ref, the references in the literature to the data in the input info</p></li>
<li><p><strong>outfile</strong> (<cite>str</cite>) – Output filename. ionS + ‘.elvlc’ (in current directory) if None</p></li>
<li><p><strong>round</strong> (<cite>int</cite>) – input to ‘np.round’ to round input values to maintain the correct number of significant figures</p></li>
<li><p><strong>addLvl</strong> (<cite>int</cite>) – Add a constant value to the index of all levels</p></li>
<li><p><strong>includeRyd</strong> (<cite>bool</cite>) – If True, write the Rydberg energies in the extended area, delimited by a comma</p></li>
<li><p><strong>includeEv</strong> (<cite>bool</cite>) – If True, write the energies in eV in the extended area, delimited by a comma</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For use with files created after elvlc format change in November 2012</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.archival.elvlcWrite" title="ChiantiPy.tools.archival.elvlcWrite"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChiantiPy.tools.archival.elvlcWrite()</span></code></a></dt><dd><p>Write .elvlc file using the old format.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.emRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">emRead</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.emRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read emission measure file <cite>emName</cite> and return the temperatures, densities and emission measures</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – the name of the emission measure file to read in the $XUVTOP/em directory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>EM</strong> – keywords are <cite>temperature</cite>, <cite>density</cite>, <cite>em</cite>, <cite>filename</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.fblvlRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">fblvlRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.fblvlRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a Chianti energy level file for calculating the
free-bound continuum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.gffRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">gffRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.gffRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the free-free gaunt factors of <a class="footnote-reference brackets" href="#id5" id="id4">1</a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets">1</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>Sutherland, R. S., 1998, MNRAS, <a class="reference external" href="http://adsabs.harvard.edu/abs/1998MNRAS.300..321S">300, 321</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function reads the file and reverses the values of g2 and u</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.gffintRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">gffintRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.gffintRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the integrated free-free gaunt factors of <a class="footnote-reference brackets" href="#id5" id="id7">1</a>.</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.grndLevelsRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">grndLevelsRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.grndLevelsRead" title="Permalink to this definition">¶</a></dt>
<dd><p>to read the grndLevels.dat file
give the number of ground levels to sum over
in populate and drPopulate</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.ioneqRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">ioneqRead</code><span class="sig-paren">(</span><em class="sig-param">ioneqName=''</em>, <em class="sig-param">minIoneq=1e-20</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.ioneqRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an ioneq file
ionization equilibrium values less then minIoneq are returns as zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ioneqName</strong> (<cite>str</cite>) – reads the file in the $XUVTOP/ioneq directory, if a blank, the default is read</p></li>
<li><p><strong>minIoneq</strong> (<cite>float</cite>) – sets values to zero if less the minIoneq</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – if true, prints into to the terminal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>{‘ioneqname’,’ioneqAll’,’ioneqTemperature’,’ioneqRef’}</strong> – Ionization equilibrium values and the reference to the literature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.ipRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">ipRead</code><span class="sig-paren">(</span><em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.ipRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the ionization potential file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ip</strong> – Ionization potential (in eV)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.itohRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">itohRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.itohRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in the free-free gaunt factors of <a class="footnote-reference brackets" href="#id9" id="id8">2</a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id8">2</a></span></dt>
<dd><p>Itoh, N. et al., 2000, ApJS, <a class="reference external" href="http://adsabs.harvard.edu/abs/2000ApJS..128..125I">128, 125</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.klgbfnRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">klgbfnRead</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.klgbfnRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI files containing the free-bound gaunt factors for n=1-6 from <a class="footnote-reference brackets" href="#id12" id="id11">14</a>.
This reads the corrected KL files in CHIANTI version 10+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – the filename for the KL data in the continuum directory, such as klgfb_1.dat, n=1,6</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>[{‘pe’, ‘klgfb’}]</strong> – Photon energy and the bound-free gaunt factors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id11">14</a></span></dt>
<dd><p>Karzas and Latter, 1961, ApJSS, <a class="reference external" href="http://adsabs.harvard.edu/abs/1961ApJS....6..167K">6, 167</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.maoParsRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">maoParsRead</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.maoParsRead" title="Permalink to this definition">¶</a></dt>
<dd><p>to read the mao et al par2.dat file for calculating the
ratio of rrloss to rrrecomb
The electron energy-loss rate due to radiative recombination.
Mao J., Kaastra J., Badnell N.R.
&lt;Astron. Astrophys. 599, A10 (2017)&gt;
=2017A&amp;A…599A..10M
1-  2  I2    —     s         Isoelectronic sequence number
4-  5  I2    —     z         Atomic number
7- 16  E10.4 —     a0        Primary fitting parameter
18- 27  E10.4 —     b0        Primary fitting parameter
29- 38  E10.4 —     c0        Addiational fitting parameter
40- 49  E10.4 —     a1        Primary fitting parameter
51- 60  E10.4 —     b1        Primary fitting parameter
62- 71  E10.4 —     a2        Addiational fitting parameter
73- 82  E10.4 —     b2        Addiational fitting parameter
84- 86  F3.1  —     mdp       Maximum deviation in percent</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.masterListInfo">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">masterListInfo</code><span class="sig-paren">(</span><em class="sig-param">force=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.masterListInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about ions in the CHIANTI masterlist.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force</strong> (<cite>bool</cite>) – if true, recreates the masterListInfo file</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – if true, prints into to the terminal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>masterListInfo</strong> – {‘wmin’, ‘wmax’, ‘tmin’, ‘tmax’} Minimum and maximum wavelengths in
the wgfa file. Minimum and maximum temperatures for which the
ionization balance is nonzero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function speeds up multi-ion spectral calculations.
The information is stored in a pickled file ‘masterlist_ions.pkl’
If the file is not found, one will be created.</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.masterListRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">masterListRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.masterListRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a CHIANTI masterlist file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>masterlist</strong> – All ions in Chianti database</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.rrLossRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">rrLossRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.rrLossRead" title="Permalink to this definition">¶</a></dt>
<dd><p>to read the Mao 2017 rr loss parameters <a class="footnote-reference brackets" href="#id15" id="id14">12</a></p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id14">12</a></span></dt>
<dd><p>Mao J., Kaastra J., Badnell N.R., <a class="reference external" href="http://adsabs.harvard.edu/abs/2017A%26A...599A..10M">2017 Astron. Astrophys. 599, A10</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.rrRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">rrRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.rrRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI radiative recombination .rrparams files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘rrtype’,’params’,’ref’}</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.scupsRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">scupsRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.scupsRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the new format v8 scups file containing the scaled temperature and upsilons from <a class="footnote-reference brackets" href="#id39" id="id16">8</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – if True, prints info to the terminal</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.splomRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">splomRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">ea=False</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.splomRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read chianti .splom files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ea</strong> (<cite>bool</cite>) – if true, reads the  .easplom file</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘lvl1’, ‘lvl2’, ‘ttype’, ‘gf’, ‘deryd’, ‘c’, ‘splom’, ‘ref’}</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Still needed for ionization cross sections</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.splupsRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">splupsRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">filetype='splups'</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.splupsRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a CHIANTI .splups file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>filetype</strong> (<cite>str</cite>, optional) – {<cite>psplups</cite>,`cisplups`,`splups`} Type of file to read</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘lvl1’, ‘lvl2’, ‘ttype’, ‘gf’, ‘de’, ‘cups’, ‘bsplups’, ‘ref’}</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.twophotonHRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">twophotonHRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.twophotonHRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the two-photon Einstein A values and distribution function for the H sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘y0’, ‘z0’, ‘avalue’, ‘asum’, ‘psi0’}</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.twophotonHeRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">twophotonHeRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.twophotonHeRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the two-photon Einstein A values and distribution function for the He sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘y0’, ‘avalue’, ‘psi0’}</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.vernerRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">vernerRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.vernerRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the photoionization cross-section data from <a class="footnote-reference brackets" href="#id18" id="id17">6</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>{‘pqn’,’l’,’eth’,’e0’,’sig0’,’ya’,’p’, yw’}</strong> – <cite>pqn</cite> is the principal quantum number, <cite>l</cite> is the subshell orbital quantum number, <cite>eth</cite> (in eV) is the subshell ionization threshold energy; <cite>sig0</cite>, <cite>ya</cite>, <cite>p</cite>, and <cite>yw</cite> are all fit parameters used in calculating the total photoionization cross-section.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id17">6</a></span></dt>
<dd><p>Verner &amp; Yakovlev, 1995, A&amp;AS, <a class="reference external" href="http://adsabs.harvard.edu/abs/1995A%26AS..109..125V">109, 125</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.versionRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">versionRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.versionRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the version number of the CHIANTI database</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.wgfaRead">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">wgfaRead</code><span class="sig-paren">(</span><em class="sig-param">ions</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">elvlcname=0</em>, <em class="sig-param">total=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.wgfaRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CHIANTI data from a .wgfa file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<cite>str</cite>) – Ion, e.g. ‘c_5’ for C V</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – Custom filename, will override that specified by <cite>ions</cite></p></li>
<li><p><strong>elvlcname</strong> (<cite>str</cite>) – If specified, the lsj term labels are returned in the ‘pretty1’ and ‘pretty2’
keys of ‘Wgfa’ dict</p></li>
<li><p><strong>total</strong> (<cite>bool</cite>) – Return the summed level 2 avalue data in ‘Wgfa’</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>Wgfa</strong> – Information read from the .wgfa file. The dictionary structure is
{“lvl1”,”lvl2”,”wvl”,”gf”,”avalue”,”ref”,”ionS”,”filename”}</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.archival.wgfaRead" title="ChiantiPy.tools.archival.wgfaRead"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChiantiPy.tools.archival.wgfaRead()</span></code></a></dt><dd><p>Read .wgfa file with the old format.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.wgfaWrite">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">wgfaWrite</code><span class="sig-paren">(</span><em class="sig-param">info</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">minBranch=1e-05</em>, <em class="sig-param">rightDigits=4</em>, <em class="sig-param">maxLvl1=None</em>, <em class="sig-param">comment=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.wgfaWrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a CHIANTI .wgfa file</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>info</strong> (<cite>dict</cite>) – Should contain the following keys:
ionS, the Chianti style name of the ion such as c_4 for C IV,
lvl1, the lower level, the ground level is 1,
lvl2, the upper level,
wvl, the wavelength (in Angstroms),
gf,the weighted oscillator strength,
avalue, the A value,
pretty1, descriptive text of the lower level (optional),
pretty2, descriptive text of the upper level (optiona),
ref, reference text, a list of strings</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>)</p></li>
<li><p><strong>minBranch</strong> (<cite>~numpy.float64</cite>) –</p>
<dl class="simple">
<dt>The transition must have a branching ratio greater than the specified minBranch</dt><dd><p>to be written to the file.  default = 1.e-5</p>
</dd>
</dl>
</li>
<li><p><strong>rightDigits</strong> (<cite>int</cite>) – the number of digits to the right of the decimal point in the wavelength
default = 5</p></li>
<li><p><strong>maxLvl1</strong> (<cite>int</cite>) – the largest level to be written. default is None</p></li>
<li><p><strong>comment</strong> (<cite>str</cite>) – add a comment to the reference section.  default = None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.io.zion2name">
<code class="sig-prename descclassname">ChiantiPy.tools.io.</code><code class="sig-name descname">zion2name</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.io.zion2name" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <cite>Z</cite> and <cite>ion</cite> to generic name, e.g. 26, 13 -&gt; fe_13</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – the nuclear charge, for example 26 for Fe XIV</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ion stage, for example, 14 for Fe XIV</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><p><strong>dielectronic</strong> (<cite>bool</cite>) – if True, created the name of a dielectronic ion, with a ‘d’ at the end</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id20">
<p class="admonition-title">Todo</p>
<p>See if dielectronic is still appropriate</p>
<p>Put in separate module to avoid multiple copies</p>
</div>
<p class="rubric">Notes</p>
<p>A duplicate of the routine in <cite>ChiantiPy.tools.util</cite> but needed by masterList Info</p>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools.mputil">
<span id="chiantipy-tools-mputil-module"></span><h2>ChiantiPy.tools.mputil module<a class="headerlink" href="#module-ChiantiPy.tools.mputil" title="Permalink to this headline">¶</a></h2>
<p>Functions needed for standard Python multiprocessing module mspectrum</p>
<dl class="function">
<dt id="ChiantiPy.tools.mputil.doFbLossQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doFbLossQ</code><span class="sig-paren">(</span><em class="sig-param">inQ</em>, <em class="sig-param">outQ</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doFbLossQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.continuum.freeBound</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQ</strong> (<cite>~multiprocessing.Queue</cite>) – Ion free-bound emission jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQ</strong> (<cite>~multiprocessing.Queue</cite>) – Finished free-bound emission jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.mputil.doFbQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doFbQ</code><span class="sig-paren">(</span><em class="sig-param">inQ</em>, <em class="sig-param">outQ</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doFbQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.continuum.freeBound</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQ</strong> (<cite>~multiprocessing.Queue</cite>) – Ion free-bound emission jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQ</strong> (<cite>~multiprocessing.Queue</cite>) – Finished free-bound emission jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.mputil.doFfLossQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doFfLossQ</code><span class="sig-paren">(</span><em class="sig-param">inQ</em>, <em class="sig-param">outQ</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doFfLossQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.continuum.freeFreeLoss</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQ</strong> (<cite>~multiprocessing.Queue</cite>) – Ion free-free emission jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQ</strong> (<cite>~multiprocessing.Queue</cite>) – Finished free-free emission jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.mputil.doFfQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doFfQ</code><span class="sig-paren">(</span><em class="sig-param">inQ</em>, <em class="sig-param">outQ</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doFfQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.continuum.freeFree</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQ</strong> (<cite>~multiprocessing.Queue</cite>) – Ion free-free emission jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQ</strong> (<cite>~multiprocessing.Queue</cite>) – Finished free-free emission jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.mputil.doIonLossQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doIonLossQ</code><span class="sig-paren">(</span><em class="sig-param">inQueue</em>, <em class="sig-param">outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doIonLossQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.ion</cite> and <cite>ChiantiPy.core.ion.twoPhoton</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQueue</strong> (<cite>~multiprocessing.Queue</cite>) – Jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQueue</strong> (<cite>~multiprocessing.Queue</cite>) – Finished jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.mputil.doIonQ">
<code class="sig-prename descclassname">ChiantiPy.tools.mputil.</code><code class="sig-name descname">doIonQ</code><span class="sig-paren">(</span><em class="sig-param">inQueue</em>, <em class="sig-param">outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.mputil.doIonQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing helper for <cite>ChiantiPy.core.ion</cite> and <cite>ChiantiPy.core.ion.twoPhoton</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inQueue</strong> (<cite>~multiprocessing.Queue</cite>) – Jobs queued up by multiprocessing module</p></li>
<li><p><strong>outQueue</strong> (<cite>~multiprocessing.Queue</cite>) – Finished jobs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools.sources">
<span id="chiantipy-tools-sources-module"></span><h2>ChiantiPy.tools.sources module<a class="headerlink" href="#module-ChiantiPy.tools.sources" title="Permalink to this headline">¶</a></h2>
<p>Blackbody temperature calculations</p>
<dl class="class">
<dt id="ChiantiPy.tools.sources.blackStar">
<em class="property">class </em><code class="sig-prename descclassname">ChiantiPy.tools.sources.</code><code class="sig-name descname">blackStar</code><span class="sig-paren">(</span><em class="sig-param">temperature</em>, <em class="sig-param">radius</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.sources.blackStar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Calculate blackbody radiation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>~numpy.ndarray</cite>) – Temperature in Kelvin</p></li>
<li><p><strong>radius</strong> (<cite>~numpy.ndarray</cite>) – Stellar radius in cm</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Temperature</strong> (<cite>~numpy.ndarray</cite>) – Temperature in Kelvin</p></li>
<li><p><strong>Radius</strong> (<cite>~numpy.ndarray</cite>) – Stellar radius in cm</p></li>
<li><p><strong>Incident</strong> (<cite>~numpy.ndarray</cite>) – Blackbody photon distribution</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="ChiantiPy.tools.sources.blackStar.incident">
<code class="sig-name descname">incident</code><span class="sig-paren">(</span><em class="sig-param">distance</em>, <em class="sig-param">energy</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.sources.blackStar.incident" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate photon distribution times the visible cross-sectional area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> (<cite>~numpy.ndarray</cite>) – Distance to the stellar object in cm</p></li>
<li><p><strong>energy</strong> (<cite>~numpy.ndarray</cite>) – Energy range in erg</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function returns the photon distribution instead of the distribution times the cross-sectional area. Is this correct? Why is the incident photon distribution calculated at all?</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.sources.blackbody">
<code class="sig-prename descclassname">ChiantiPy.tools.sources.</code><code class="sig-name descname">blackbody</code><span class="sig-paren">(</span><em class="sig-param">temperature</em>, <em class="sig-param">variable</em>, <em class="sig-param">hnu=1</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.sources.blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the blackbody photon distribution as a function of energy (<cite>hnu</cite> = 1) or as a function of wavelength (<cite>hnu</cite> = 0) in units of  <span class="math notranslate nohighlight">\(\mathrm{photons}\,\mathrm{cm}^{-2}\,\mathrm{s}^{-1}\,\mathrm{str}^{-1}\,\mathrm{erg}^{-1}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>~numpy.float64</cite>) – Temperature at which to calculate the blackbody photon distribution</p></li>
<li><p><strong>variable</strong> (<cite>~numpy.ndarray</cite>) – Either energy (in erg) or wavelength (in angstrom)</p></li>
<li><p><strong>hnu</strong> (<cite>int</cite>) – If 1, calculate distribution as a function of energy. Otherwise, calculate it as a function of wavelength</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>{‘photons’, ‘temperature’, ‘energy’} or {‘photons’, ‘temperature’, ‘wvl’}</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools.util">
<span id="chiantipy-tools-util-module"></span><h2>ChiantiPy.tools.util module<a class="headerlink" href="#module-ChiantiPy.tools.util" title="Permalink to this headline">¶</a></h2>
<p>Utility functions</p>
<p class="rubric">Notes</p>
<p>Some of these functions can be replaced by roman numeral and periodic table lookup libraries.
some functions using os.walk can be replaced by os.path</p>
<dl class="function">
<dt id="ChiantiPy.tools.util.between">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">between</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">limits</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.between" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the indices of <cite>array</cite> corresponding to values in the range given by <cite>limits</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<cite>list</cite>, <cite>ndarray</cite>) – contains a list of elements such a wavelengths</p></li>
<li><p><strong>limits</strong> (<cite>list</cite>, <cite>ndarray</cite>) – a 2 element array specifying the lower and upper limits of the array to be included</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.convertName">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">convertName</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.convertName" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert ion name string (e.g. ‘fe_13’) to atomic number and ion number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<cite>str</cite>) – the CHIANTI style name for an ion, such as fe_14</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>{‘Z’, ‘Ion’, ‘Dielectronic’, ‘Element’, ‘higher’, ‘lower’}</strong> – <cite>higher</cite> and <cite>lower</cite> are the Chianti-style names for the higher and lower ionization stages, respectively.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.descale_bt">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">descale_bt</code><span class="sig-paren">(</span><em class="sig-param">bte</em>, <em class="sig-param">btomega</em>, <em class="sig-param">f</em>, <em class="sig-param">ev1</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.descale_bt" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply excitation descaling of <a class="footnote-reference brackets" href="#id22" id="id21">3</a> to energy and collision strength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bte</strong> (<em>array-like</em>) – Scaled energy</p></li>
<li><p><strong>btomega</strong> (<em>array-like</em>) – Scaled collision strength</p></li>
<li><p><strong>f</strong> (<em>array-like</em>)</p></li>
<li><p><strong>ev1</strong> (<em>array-like</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>[energy,omega]</strong> – Descaled energy and collision strength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Need more details here. Not clear which equations are being used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.util.scale_bt" title="ChiantiPy.tools.util.scale_bt"><code class="xref py py-func docutils literal notranslate"><span class="pre">scale_bt()</span></code></a></dt><dd><p>Apply scaling to excitation energy and cross-section</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id21">3</a></span></dt>
<dd><p>Burgess, A. and Tully, J. A., 1992, A&amp;A, <a class="reference external" href="http://adsabs.harvard.edu/abs/1992A%26A...254..436B">254, 436</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.descale_bti">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">descale_bti</code><span class="sig-paren">(</span><em class="sig-param">bte</em>, <em class="sig-param">btx</em>, <em class="sig-param">f</em>, <em class="sig-param">ev1</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.descale_bti" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply ionization descaling of <a class="footnote-reference brackets" href="#id27" id="id24">9</a> to energy and cross-sections of <a class="footnote-reference brackets" href="#id37" id="id25">7</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bte</strong> (<em>array-like</em>) – Scaled energy</p></li>
<li><p><strong>btx</strong> (<em>array-like</em>) – Scaled cross-section</p></li>
<li><p><strong>f</strong> (<em>float</em>) – Scaling parameter</p></li>
<li><p><strong>ev1</strong> (<em>float</em>) – ionization potential - units determine the output energy units</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>[energy,cross]</strong> – Descaled energy and cross-section</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the scaling used and discussed in the Dere (2007) calculation <a class="footnote-reference brackets" href="#id37" id="id26">7</a> of cross sections.  It was derived from similar scalings provided by reference [2]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.util.scale_bti" title="ChiantiPy.tools.util.scale_bti"><code class="xref py py-func docutils literal notranslate"><span class="pre">scale_bti()</span></code></a></dt><dd><p>Descale ionization energy and cross-section</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id27"><span class="brackets"><a class="fn-backref" href="#id24">9</a></span></dt>
<dd><p>Burgess, A. and Tully, J. A., 1992, A&amp;A, <a class="reference external" href="http://adsabs.harvard.edu/abs/1992A%26A...254..436B">254, 436</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.descale_bti_rate">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">descale_bti_rate</code><span class="sig-paren">(</span><em class="sig-param">btTemperature</em>, <em class="sig-param">btRate</em>, <em class="sig-param">ip</em>, <em class="sig-param">f=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.descale_bti_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply ionization descaling of <a class="footnote-reference brackets" href="#id37" id="id29">7</a>, a Burgess-Tully type scaling to bt scaled ionization rates and
temperatures.  The result is to return a temperature array and a ionization rate array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btTemperature</strong> (<cite>array-like</cite>) – the bt scaled temperature</p></li>
<li><p><strong>btRate</strong> (<cite>array-like</cite>) – the bt scaled ionization rate</p></li>
<li><p><strong>ip</strong> (<cite>float</cite>) – the ionization potential in eV.</p></li>
<li><p><strong>f</strong> (<cite>float</cite> (optional)) – the scaling parameter, 1.7 generally works well</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.dilute">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">dilute</code><span class="sig-paren">(</span><em class="sig-param">radius</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.dilute" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the dilution factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radius</strong> (<em>array-like</em>) – Distance from the center of a star in units of the stellar radius.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>radius</cite> is less than 1.0, returns 0.</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.el2z">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">el2z</code><span class="sig-paren">(</span><em class="sig-param">els</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.el2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert elemental symbol to atomic number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>els</strong> (<em>str</em>) – the abreviated element name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>z</strong> – the atomic number or nuclear charge of the element</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.findFileTypes">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">findFileTypes</code><span class="sig-paren">(</span><em class="sig-param">wpath</em>, <em class="sig-param">type='*.txt'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.findFileTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>to find all the files in wpath and below with file names matching fname</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.ion2filename">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">ion2filename</code><span class="sig-paren">(</span><em class="sig-param">ions</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.ion2filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert ion name string to generic directory-file name.
convertName has probably made this redundant</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ions</strong> (<em>str</em>) – the CHIANTI style name for an ion, such as fe_14</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fname</strong> – the full file name of the ion directory in the CHIANTI database
assumes a top directory from the environmental variable XUVTOP</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id30">
<p class="admonition-title">Todo</p>
<p>this duplicates what ‘convertName’ does</p>
</div>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.listFiles">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">listFiles</code><span class="sig-paren">(</span><em class="sig-param">dir</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.listFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks the path and subdirectories to return a list of files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dir</strong> (<em>str</em>) – the top directory to search
subdirectories are also searched</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>listname</strong> – a list of files in dir and  subdirectories</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This can be replaced by functions in <cite>os.path</cite>, as if 3.4, pathlib is probably better.
It is not clear that this function is used anywhere in ChiantiPy</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.listRootNames">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">listRootNames</code><span class="sig-paren">(</span><em class="sig-param">dir</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.listRootNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks the path and subdirectories to return a list of file root names.</p>
<p class="rubric">Notes</p>
<p>This can be replaced by functions in <cite>os.path</cite>, as if 3.4, pathlib is probably better.
Only seems to be used by</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.qrp">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">qrp</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">u</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.qrp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <span class="math notranslate nohighlight">\(Q_R^{\prime}(Z,u)\)</span>, where <span class="math notranslate nohighlight">\(u=\epsilon/I\)</span> is the impact electron energy in threshold units, from Eq. 2.12 of <a class="footnote-reference brackets" href="#id32" id="id31">4</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – Atomic number</p></li>
<li><p><strong>u</strong> (<em>array-like</em>) – Impact electron energy in threshold units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>q</strong> – 1s ionization cross-section, <span class="math notranslate nohighlight">\(Q_R^{\prime}(Z,u)\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Used for calculations of direct ionization cross-sections of the H and He sequences in <cite>ChiantiPy.tools.io.twophotonHRead</cite> and <cite>ChiantiPy.tools.io.twophotonHeRead</cite>, respectively.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id32"><span class="brackets"><a class="fn-backref" href="#id31">4</a></span></dt>
<dd><p>Fontes, C. et al., 1999, PhRvA, <a class="reference external" href="http://adsabs.harvard.edu/abs/1999PhRvA..59.1329F">59, 1329</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.scale_bt">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">scale_bt</code><span class="sig-paren">(</span><em class="sig-param">evin</em>, <em class="sig-param">omega</em>, <em class="sig-param">f</em>, <em class="sig-param">ev1</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.scale_bt" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply excitation scaling of <a class="footnote-reference brackets" href="#id39" id="id34">8</a> to energy and collision strength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evin</strong> (<em>array-like</em>)</p></li>
<li><p><strong>omega</strong> (<em>array-like</em>)</p></li>
<li><p><strong>f</strong> (<em>array-like</em>)</p></li>
<li><p><strong>ev1</strong> (<em>array-like</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>[bte,btomega]</strong> – Scaled energy and collision strength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Need more details here. Not clear which equations are being used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.util.descale_bt" title="ChiantiPy.tools.util.descale_bt"><code class="xref py py-func docutils literal notranslate"><span class="pre">descale_bt()</span></code></a></dt><dd><p>Descale excitation energy and cross-section</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.scale_bt_rate">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">scale_bt_rate</code><span class="sig-paren">(</span><em class="sig-param">inDict</em>, <em class="sig-param">ip</em>, <em class="sig-param">f=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.scale_bt_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply ionization scaling of <a class="footnote-reference brackets" href="#id37" id="id35">7</a>, a Burgess-Tully type scaling to ionization rates and
temperatures. The result of the scaling is to return a scaled temperature between 0 and 1 and a
slowly varying scaled rate as a function of scaled temperature. In addition, the scaled rates
vary slowly along an iso-electronic sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inDict</strong> (<cite>dict</cite>) – the input dictionary should have the following key pairs: <cite>temperature</cite>, array-like and
<cite>rate</cite>, array-like</p></li>
<li><p><strong>ip</strong> (<cite>float</cite>) – the ionization potential in eV.</p></li>
<li><p><strong>f</strong> (<cite>float</cite> (optional)) – the scaling parameter, 1.7 generally works well</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><cite>btTemperature</cite> and <cite>btRate</cite> keys are added to <cite>inDict</cite></p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.scale_bti">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">scale_bti</code><span class="sig-paren">(</span><em class="sig-param">evin</em>, <em class="sig-param">crossin</em>, <em class="sig-param">f</em>, <em class="sig-param">ev1</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.scale_bti" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply ionization scaling of <a class="footnote-reference brackets" href="#id37" id="id36">7</a>,[8]_, to energy and cross-section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evin</strong> (<em>float</em>) – Energy - same units as ev1</p></li>
<li><p><strong>crossin</strong> (<em>array-like</em>) – Cross-section</p></li>
<li><p><strong>f</strong> (<em>float -  the scale factor</em>)</p></li>
<li><p><strong>ev1</strong> (<em>float</em>) – the ionization potential
units - the same as evin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>[bte,btx]</strong> – Scaled energy and cross-section</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the scaling used and discussed in the Dere (2007) calculation [1] of cross sections.  It was derived from similar scalings derived in reference [2]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ChiantiPy.tools.util.descale_bti" title="ChiantiPy.tools.util.descale_bti"><code class="xref py py-func docutils literal notranslate"><span class="pre">descale_bti()</span></code></a></dt><dd><p>Descale ionization energy and cross-section</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id37"><span class="brackets">7</span><span class="fn-backref">(<a href="#id25">1</a>,<a href="#id26">2</a>,<a href="#id29">3</a>,<a href="#id35">4</a>,<a href="#id36">5</a>)</span></dt>
<dd><p>Dere, K. P., 2007, A&amp;A, <a class="reference external" href="http://adsabs.harvard.edu/abs/2007A%26A...466..771D">466, 771,</a></p>
</dd>
<dt class="label" id="id39"><span class="brackets">8</span><span class="fn-backref">(<a href="#id16">1</a>,<a href="#id34">2</a>)</span></dt>
<dd><p>Burgess, A. and Tully, J. A., 1992, A&amp;A, <a class="reference external" href="http://adsabs.harvard.edu/abs/1992A%26A...254..436B">254, 436</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.scale_classical">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">scale_classical</code><span class="sig-paren">(</span><em class="sig-param">inDict</em>, <em class="sig-param">ip</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.scale_classical" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the classical scaling to the input data</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>inDict</strong> (<em>dictionary</em>) –</p>
<dl class="simple">
<dt>the input dictionary should have the following key pairs</dt><dd><p>energy and cross
or
temperature and rate</p>
</dd>
</dl>
</li>
<li><p><strong>energy</strong> (<em>array-like</em>) – energy values of the cross-section</p></li>
<li><p><strong>cross</strong> (<em>array-like</em>) – a cross-section</p></li>
<li><p><strong>temperature</strong> (<em>array-like</em>)</p></li>
<li><p><strong>rate</strong> (<em>array-like</em>)</p></li>
<li><p><strong>ip</strong> (<em>float</em>) – the ionization potential.  Typically in eV.</p></li>
<li><p><strong>Returns</strong> – the following keys are added to inDict</p></li>
<li><p><strong>——-</strong></p></li>
<li><p><strong>{‘csEnergy’, ‘csCross’, ‘ip’} or {‘csTemperature’, ‘csRate’, ‘ip’}</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.spectroscopic2name">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">spectroscopic2name</code><span class="sig-paren">(</span><em class="sig-param">el</em>, <em class="sig-param">roman</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.spectroscopic2name" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from spectroscopic notation, e.g. Fe XI to ‘fe_11’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>el</strong> (<cite>str</cite>) – Elemental symbol, e.g. Fe for iron</p></li>
<li><p><strong>roman</strong> (<cite>str</cite>) – Roman numeral spectroscopic symbol</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.splomDescale">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">splomDescale</code><span class="sig-paren">(</span><em class="sig-param">splom</em>, <em class="sig-param">energy</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.splomDescale" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the collision strength for excitation-autoionization as a function of energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> (<em>array-like</em>) – In eV</p></li>
<li><p><strong>splom</strong> (<cite>dict</cite>) – Structure returned by <cite>ChiantiPy.tools.io.splomRead</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>omega</strong> – Collision strength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.units">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">units</code><span class="sig-paren">(</span><em class="sig-param">defaults</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.units" title="Permalink to this definition">¶</a></dt>
<dd><p>to create a set of units compatible with ChiantiPy default values</p>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.z2element">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">z2element</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.z2element" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number <cite>z</cite> to its elemental symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>element</strong> – the abbreviated element name</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2dir">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2dir</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em>, <em class="sig-param">xuvtop=''</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number and ion number to CHIANTI database directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 1 for the neutral, 2 for the first ionization stage, …</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional)</p></li>
<li><p><strong>xuvtop</strong> (<cite>str</cite>, optional) – Set different CHIANTI database than the default</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fname</strong> – the CHIANTI directory where the file for the ion specified by z and ion are found</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2experimental">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2experimental</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2experimental" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number and ion number to spectroscopic notation string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 0 for neutrals, 1 for singly ionized</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>expt</strong> – the experimental/laboratory notation for the ion, such as Fe 13+</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2filename">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2filename</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em>, <em class="sig-param">xuvtop=''</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert nuclear charge/atomic number and ion number to CHIANTI database filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 1 for neutrals, 2 for singly ionized</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional) – whether the ion is the simple dielectronic model</p></li>
<li><p><strong>xuvtop</strong> (<cite>str</cite>, optional) – the top directory of the CHIANTI database to be used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fname</strong> – CHIANTI database filename</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2localFilename">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2localFilename</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2localFilename" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number and ion number to generic file name with current directory at top.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 1 for neutrals, 2 for singly ionized</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2name">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2name</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2name" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number and ion number to generic name, e.g. (26,13) to ‘fe_13’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 1 for the neutral, 2 for the first ionization stage, …</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>thisone</strong> – the CHIANTI style ion name, such as ‘fe_13’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ChiantiPy.tools.util.zion2spectroscopic">
<code class="sig-prename descclassname">ChiantiPy.tools.util.</code><code class="sig-name descname">zion2spectroscopic</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">ion</em>, <em class="sig-param">dielectronic=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ChiantiPy.tools.util.zion2spectroscopic" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic number and ion number to spectroscopic notation string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<cite>int</cite>) – The atomic number/nuclear charge</p></li>
<li><p><strong>ion</strong> (<cite>int</cite>) – the ionization stage, 1 for neutrals, 2 for singly ionized</p></li>
<li><p><strong>dielectronic</strong> (<cite>bool</cite>, optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spect</strong> – the spectroscopic notation for the ion, such as Fe XIV</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ChiantiPy.tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ChiantiPy.tools" title="Permalink to this headline">¶</a></h2>
<p>Basic tools and utilities used in ChiantiPy</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../notes.html" title="Notes"
             >next</a> |</li>
        <li class="right" >
          <a href="ChiantiPy.tests.html" title="ChiantiPy.tests package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ChiantiPy 0.15.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >ChiantiPy’s API documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ChiantiPy.html" >ChiantiPy package</a> &#187;</li> 
      </ul>
    </div>
<div style="padding: 20px 10px 10px 40px; background-color: #fff8d3; text-align: left;">


</div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Ken Dere.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>

  </body>
</html>